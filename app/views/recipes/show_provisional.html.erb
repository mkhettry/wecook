<script>
    $(document).ready(function(){

        $("select").change(function(event){
            //change css class of line
            var line_id = $(this).attr('id').replace("select","line");
            var line_class = $('#'+line_id).attr('class');
            $('#'+line_id).removeClass(line_class);
            $('#'+line_id).addClass($(this).val());
            //add changed text
            $('#text_field').val($('#text_field').val() + '|' + line_id.replace("prov_line","") + '=' + $(this).val());
        });

        $("div.prov").hover(
                function(event){
                    var select_id = $(this).attr('id').replace("prov_","prov_select");
                    $('#'+select_id).show();
                },
                function(event){
                    var select_id = $(this).attr('id').replace("prov_","prov_select");
                    $('#'+select_id).hide();
                }
        );
    })
</script>

<% @recipe.get_lines_with_prediction.each_with_index do |map,idx| %>
    <% id_string = idx.to_s %>

    <div id= "<%='prov_'+id_string %>" class="prov">

      <div id= "<%= 'prov_line'+id_string %>" class="<%= map[:class]%>" >
        <%=  map[:line] %>
      </div>

      <div>
        <%= select_tag "prov_select"+id_string, options_for_select(RecipesHelper::CATEGORY_MAP, map[:class]), :style => "display:none", :class => "prov_select" %>
      </div>

    </div>
<% end %>

<br/>
<%= form_tag(submit_provisional_recipe_path(@recipe)) do %>
    <%= text_field_tag :changed, nil, :id => "text_field", :style => "display:none" %>
    <%= submit_tag 'Save Changes' %>
<% end %>
